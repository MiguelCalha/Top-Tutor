{
  "version": 3,
  "sources": ["../../src/lib/compareSchemas.ts"],
  "sourcesContent": ["import { SerializedSchema } from './StoreSchema'\n\n/** @public */\nexport const compareSchemas = (a: SerializedSchema, b: SerializedSchema): 0 | 1 | -1 => {\n\tif (a.schemaVersion > b.schemaVersion) {\n\t\treturn 1\n\t}\n\tif (a.schemaVersion < b.schemaVersion) {\n\t\treturn -1\n\t}\n\tif (a.storeVersion > b.storeVersion) {\n\t\treturn 1\n\t}\n\tif (a.storeVersion < b.storeVersion) {\n\t\treturn -1\n\t}\n\tfor (const key of Object.keys(a.recordVersions)) {\n\t\tconst aRecordVersion = a.recordVersions[key]\n\t\tconst bRecordVersion = b.recordVersions[key]\n\t\tif (aRecordVersion.version > bRecordVersion.version) {\n\t\t\treturn 1\n\t\t}\n\t\tif (aRecordVersion.version < bRecordVersion.version) {\n\t\t\treturn -1\n\t\t}\n\t\tif ('subTypeVersions' in aRecordVersion && !('subTypeVersions' in bRecordVersion)) {\n\t\t\t// todo: this assumes that subtypes were added in an up migration rather than removed. We should probably\n\t\t\t// make sure that in either case the parent version is bumped\n\t\t\treturn 1\n\t\t}\n\n\t\tif (!('subTypeVersions' in aRecordVersion) && 'subTypeVersions' in bRecordVersion) {\n\t\t\t// todo: this assumes that subtypes were added in an up migration rather than removed. We should probably\n\t\t\t// make sure that in either case the parent version is bumped\n\t\t\treturn -1\n\t\t}\n\n\t\tif (!('subTypeVersions' in aRecordVersion) || !('subTypeVersions' in bRecordVersion)) {\n\t\t\t// this will never happen\n\t\t\tcontinue\n\t\t}\n\n\t\tfor (const subType of Object.keys(aRecordVersion.subTypeVersions)) {\n\t\t\tconst aSubTypeVersion = aRecordVersion.subTypeVersions[subType]\n\t\t\tconst bSubTypeVersion = bRecordVersion.subTypeVersions[subType]\n\t\t\tif (aSubTypeVersion > bSubTypeVersion) {\n\t\t\t\treturn 1\n\t\t\t}\n\t\t\tif (aSubTypeVersion < bSubTypeVersion) {\n\t\t\t\treturn -1\n\t\t\t}\n\t\t}\n\t}\n\treturn 0\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAGO,MAAM,iBAAiB,CAAC,GAAqB,MAAoC;AACvF,MAAI,EAAE,gBAAgB,EAAE,eAAe;AACtC,WAAO;AAAA,EACR;AACA,MAAI,EAAE,gBAAgB,EAAE,eAAe;AACtC,WAAO;AAAA,EACR;AACA,MAAI,EAAE,eAAe,EAAE,cAAc;AACpC,WAAO;AAAA,EACR;AACA,MAAI,EAAE,eAAe,EAAE,cAAc;AACpC,WAAO;AAAA,EACR;AACA,aAAW,OAAO,OAAO,KAAK,EAAE,cAAc,GAAG;AAChD,UAAM,iBAAiB,EAAE,eAAe,GAAG;AAC3C,UAAM,iBAAiB,EAAE,eAAe,GAAG;AAC3C,QAAI,eAAe,UAAU,eAAe,SAAS;AACpD,aAAO;AAAA,IACR;AACA,QAAI,eAAe,UAAU,eAAe,SAAS;AACpD,aAAO;AAAA,IACR;AACA,QAAI,qBAAqB,kBAAkB,EAAE,qBAAqB,iBAAiB;AAGlF,aAAO;AAAA,IACR;AAEA,QAAI,EAAE,qBAAqB,mBAAmB,qBAAqB,gBAAgB;AAGlF,aAAO;AAAA,IACR;AAEA,QAAI,EAAE,qBAAqB,mBAAmB,EAAE,qBAAqB,iBAAiB;AAErF;AAAA,IACD;AAEA,eAAW,WAAW,OAAO,KAAK,eAAe,eAAe,GAAG;AAClE,YAAM,kBAAkB,eAAe,gBAAgB,OAAO;AAC9D,YAAM,kBAAkB,eAAe,gBAAgB,OAAO;AAC9D,UAAI,kBAAkB,iBAAiB;AACtC,eAAO;AAAA,MACR;AACA,UAAI,kBAAkB,iBAAiB;AACtC,eAAO;AAAA,MACR;AAAA,IACD;AAAA,EACD;AACA,SAAO;AACR;",
  "names": []
}
