{
  "version": 3,
  "sources": ["../../../../src/lib/primitives/geometry/Arc2d.ts"],
  "sourcesContent": ["import { Vec } from '../Vec'\nimport { intersectLineSegmentCircle } from '../intersect'\nimport { getArcMeasure, getPointInArcT, getPointOnCircle } from '../utils'\nimport { Geometry2d, Geometry2dOptions } from './Geometry2d'\nimport { getVerticesCountForLength } from './geometry-constants'\n\n/** @public */\nexport class Arc2d extends Geometry2d {\n\t_center: Vec\n\tradius: number\n\tstart: Vec\n\tend: Vec\n\n\tmeasure: number\n\tlength: number\n\tangleStart: number\n\tangleEnd: number\n\n\tconstructor(\n\t\tconfig: Omit<Geometry2dOptions, 'isFilled' | 'isClosed'> & {\n\t\t\tcenter: Vec\n\t\t\tradius: number\n\t\t\tstart: Vec\n\t\t\tend: Vec\n\t\t\tsweepFlag: number\n\t\t\tlargeArcFlag: number\n\t\t}\n\t) {\n\t\tsuper({ ...config, isFilled: false, isClosed: false })\n\t\tconst { center, radius, sweepFlag, largeArcFlag, start, end } = config\n\t\tif (start.equals(end)) throw Error(`Arc must have different start and end points.`)\n\n\t\t// ensure that the start and end are clockwise\n\t\tthis.angleStart = Vec.Angle(center, start)\n\t\tthis.angleEnd = Vec.Angle(center, end)\n\t\tthis.measure = getArcMeasure(this.angleStart, this.angleEnd, sweepFlag, largeArcFlag)\n\t\tthis.length = this.measure * radius\n\n\t\tthis.start = start\n\t\tthis.end = end\n\n\t\tthis._center = center\n\t\tthis.radius = radius\n\t}\n\n\tnearestPoint(point: Vec): Vec {\n\t\tconst { _center, measure, radius, angleEnd, angleStart, start: A, end: B } = this\n\t\tconst t = getPointInArcT(measure, angleStart, angleEnd, _center.angle(point))\n\t\tif (t <= 0) return A\n\t\tif (t >= 1) return B\n\n\t\t// Get the point (P) on the arc, then pick the nearest of A, B, and P\n\t\tconst P = _center.clone().add(point.clone().sub(_center).uni().mul(radius))\n\n\t\tlet distance = Infinity\n\t\tlet nearest: Vec | undefined\n\t\tfor (const pt of [A, B, P]) {\n\t\t\tif (point.dist(pt) < distance) {\n\t\t\t\tnearest = pt\n\t\t\t\tdistance = point.dist(pt)\n\t\t\t}\n\t\t}\n\n\t\tif (!nearest) throw Error('nearest point not found')\n\t\treturn nearest\n\t}\n\n\thitTestLineSegment(A: Vec, B: Vec, _zoom: number): boolean {\n\t\tconst { _center, radius, measure, angleStart, angleEnd } = this\n\t\tconst intersection = intersectLineSegmentCircle(A, B, _center, radius)\n\t\tif (intersection === null) return false\n\n\t\treturn intersection.some((p) => {\n\t\t\tconst result = getPointInArcT(measure, angleStart, angleEnd, _center.angle(p))\n\t\t\treturn result >= 0 && result <= 1\n\t\t})\n\t}\n\n\tgetVertices(): Vec[] {\n\t\tconst { _center, measure, length, radius, angleStart } = this\n\t\tconst vertices: Vec[] = []\n\n\t\tfor (let i = 0, n = getVerticesCountForLength(Math.abs(length)); i < n + 1; i++) {\n\t\t\tconst t = (i / n) * measure\n\t\t\tconst angle = angleStart + t\n\t\t\tvertices.push(getPointOnCircle(_center, radius, angle))\n\t\t}\n\n\t\treturn vertices\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAoB;AACpB,uBAA2C;AAC3C,mBAAgE;AAChE,wBAA8C;AAC9C,gCAA0C;AAGnC,MAAM,cAAc,6BAAW;AAAA,EACrC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAEA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAEA,YACC,QAQC;AACD,UAAM,EAAE,GAAG,QAAQ,UAAU,OAAO,UAAU,MAAM,CAAC;AACrD,UAAM,EAAE,QAAQ,QAAQ,WAAW,cAAc,OAAO,IAAI,IAAI;AAChE,QAAI,MAAM,OAAO,GAAG;AAAG,YAAM,MAAM,+CAA+C;AAGlF,SAAK,aAAa,eAAI,MAAM,QAAQ,KAAK;AACzC,SAAK,WAAW,eAAI,MAAM,QAAQ,GAAG;AACrC,SAAK,cAAU,4BAAc,KAAK,YAAY,KAAK,UAAU,WAAW,YAAY;AACpF,SAAK,SAAS,KAAK,UAAU;AAE7B,SAAK,QAAQ;AACb,SAAK,MAAM;AAEX,SAAK,UAAU;AACf,SAAK,SAAS;AAAA,EACf;AAAA,EAEA,aAAa,OAAiB;AAC7B,UAAM,EAAE,SAAS,SAAS,QAAQ,UAAU,YAAY,OAAO,GAAG,KAAK,EAAE,IAAI;AAC7E,UAAM,QAAI,6BAAe,SAAS,YAAY,UAAU,QAAQ,MAAM,KAAK,CAAC;AAC5E,QAAI,KAAK;AAAG,aAAO;AACnB,QAAI,KAAK;AAAG,aAAO;AAGnB,UAAM,IAAI,QAAQ,MAAM,EAAE,IAAI,MAAM,MAAM,EAAE,IAAI,OAAO,EAAE,IAAI,EAAE,IAAI,MAAM,CAAC;AAE1E,QAAI,WAAW;AACf,QAAI;AACJ,eAAW,MAAM,CAAC,GAAG,GAAG,CAAC,GAAG;AAC3B,UAAI,MAAM,KAAK,EAAE,IAAI,UAAU;AAC9B,kBAAU;AACV,mBAAW,MAAM,KAAK,EAAE;AAAA,MACzB;AAAA,IACD;AAEA,QAAI,CAAC;AAAS,YAAM,MAAM,yBAAyB;AACnD,WAAO;AAAA,EACR;AAAA,EAEA,mBAAmB,GAAQ,GAAQ,OAAwB;AAC1D,UAAM,EAAE,SAAS,QAAQ,SAAS,YAAY,SAAS,IAAI;AAC3D,UAAM,mBAAe,6CAA2B,GAAG,GAAG,SAAS,MAAM;AACrE,QAAI,iBAAiB;AAAM,aAAO;AAElC,WAAO,aAAa,KAAK,CAAC,MAAM;AAC/B,YAAM,aAAS,6BAAe,SAAS,YAAY,UAAU,QAAQ,MAAM,CAAC,CAAC;AAC7E,aAAO,UAAU,KAAK,UAAU;AAAA,IACjC,CAAC;AAAA,EACF;AAAA,EAEA,cAAqB;AACpB,UAAM,EAAE,SAAS,SAAS,QAAQ,QAAQ,WAAW,IAAI;AACzD,UAAM,WAAkB,CAAC;AAEzB,aAAS,IAAI,GAAG,QAAI,qDAA0B,KAAK,IAAI,MAAM,CAAC,GAAG,IAAI,IAAI,GAAG,KAAK;AAChF,YAAM,IAAK,IAAI,IAAK;AACpB,YAAM,QAAQ,aAAa;AAC3B,eAAS,SAAK,+BAAiB,SAAS,QAAQ,KAAK,CAAC;AAAA,IACvD;AAEA,WAAO;AAAA,EACR;AACD;",
  "names": []
}
